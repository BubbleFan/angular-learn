<!doctype html>
<html lang="en" ng-app="myApp">
<head>
	<meta charset="UTF-8">
	<title>myApp</title>
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no,minimal-ui" />
	<link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css">
	<script type="text/javascript" src="js/angular/angular.min.js"></script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.10/angular-route.min.js"></script>
	<style type="text/css">
		body, ul, ol, p, h2{
			margin: 0;
			padding: 0;
		}
		body{
			padding-top: 1.4rem;
			font-family: "Microsoft Yahei"
		}
		li{
			list-style: none;
		}
		a{
			text-decoration: none;
		}
		/*nav*/
		.nav{
			width: 100%;
			position: fixed;
			left: 0;
			z-index: 999;
			text-align: center;
			display: box;
			display: -webkit-box;
			display: -ms-flexbox;      /* TWEENER - IE 10 */
			display: -webkit-flex;     /* NEW - Chrome */
			display: flex;
		}

		.head{
			height: 1.4rem;
			top: 0;
			background-color: #ffffff;
			border-bottom: 1px solid #e7e7e7;
		}
		.head span{
			width: 100%;
			position: absolute;
			left: 0;
			line-height: 1.4rem;
			font-size: .54rem;
			font-weight: 200;
			text-align: center;
			color: #595959;
		}
		.foot{
			height: 1.44rem;
			bottom: 0;
			background-color: #fbfbfb;
		}
		.foot a{
			padding-top: 5px;
			width: 25%;
			display: block;
			font-size: 0.1rem;
			text-decoration: none;
			color: #888888;
		}
		.foot a.active{
			color: #ff5500;
		}
		.foot a:visited{
			border: none;
		}
		.foot a i{
			font-size: .65rem;
		}
		.foot a span{
			line-height: .6rem;
			font-size: .3rem;
		}
		/*图片轮播*/
		.carousel{
			width: 100%;
			height: 3.5rem;
			position: relative;
			overflow: hidden;
		}
		.carousel ul{
			height: 100%;
			position: absolute;
			left: 0;
			top: 0;
			transition: transform .6s ease-in-out;
			-moz-transition: -moz-transform .6s ease-in-out;
			-webkit-transition: -webkit-transform .6s ease-in-out;
		}
		.carousel ul.active1{
			transform: translate3d(0,0,0);
			-moz-transform: translate3d(0,0,0);
			-webkit-transform: translate3d(0,0,0);
		}
		.carousel ul.active2{
			transform: translate3d(-10rem,0,0);
			-moz-transform: translate3d(-10rem,0,0);
			-webkit-transform: translate3d(-10rem,0,0);
		}
		.carousel ul.active3{
			transform: translate3d(-20rem,0,0);
			-moz-transform: translate3d(-20rem,0,0);
			-webkit-transform: translate3d(-20rem,0,0);
		}
		.carousel ul li{
			width: 10rem;
			height: 100%;
			float: left;
		}
		.carousel ol{
			width: 100%;
			position: absolute;
			left: 0;
			bottom: 0;
			text-align: center;
		}
		.carousel ol li{
			padding: 0 6px;
			font-size: 14px;
			display: inline-block;
			color: #fbfbfb;
		}
		.carousel ol li.active{
			color: #ff5500;
		}

		/*产品列表*/
		.pro{
			width: 100%;
			padding: .5rem 0 0 0;
			display: box;
			display: -webkit-box;
			overflow: hidden;
			background-color: #e8e8e8;
			font-size: 0.6rem;
		}
		.pro_list{
			width: 90%;
			height: 90%;
			padding: 0 5%;
			position: relative;
			background-color: #ffffff;
		}
		.pro_list li{
			width: 100%;
			height: 100%;
			position: absolute;
			left: 0;
			top: 0;
			z-index: 1;
			border-radius: 10px;/*
			transform: matrix(0.5, 0, 0, 0.7, 50, 10);
			-moz-transform: matrix(0.5, 0, 0, 0.7, 50, 10);
			-webkit-transform: matrix(.5, 0, 0, .7, 50, 10);
			transition : all .3s ease-in-out;
			-moz-transition : all .3s ease-in-out;
			-webkit-transition : all .3s ease-in-out;*/
		}
		/*我的资产*/
		.cash{
			letter-spacing: -1px;
		}
		.cash_top{
			padding: .5rem;
			height: 3.3rem;
			background-color: #ff5500;
			font-size: .5rem;
			color: #ffffff;
		}
		.cash_top p{
			position: relative;
			height: 1rem;
			line-height: 1rem;
		}
		.cash_top a{
			position: absolute;
			right: 0;
			color: #ffffff;
		}
		.cash_top a i{
			font-size: .6rem;
		}
		.cash_top h2{
			line-height: 3rem;
			font-weight: 100;
			font-size: 2rem;
			font-family: Arial;
		}
		.cash_middle{
			height: 2.5rem;
			padding: .5rem;
			background-color: #ffffff;
			border-bottom: 1px solid red;
		}
		.cash_middle p{
			line-height: .5rem;
			font-size: .5rem;
			color: #939393;
		}
		.cash_middle h2{
			line-height: 2.4rem;
			font-weight: 100;
			font-size: 1.6rem;
			font-family: Arial;
			color: #696969;
		}
		.cash_m_yesterday, .cash_m_all{
			width: 48%;
			height: 100%;
			float: left;
		}
		.cash_m_all{
			width: 44%;
			padding-left: 5%;
			border-left: 1px solid #c7c7c7;
		}
		.cash_m_yesterday h2{
			color: #cc5500;
		}
	</style>
</head>
<body>
	
	<div ng-view></div>

	<div class="nav foot" id="foot">
		<a href="#/home" class="active">
			<i class="fa fa-star"></i><br>
			<span>精选推荐</span>
		</a>
		<a href="#/pro">
			<i class="fa fa-list-ul"></i><br>
			<span>产品列表</span>
		</a>
		<a href="#/cash">
			<i class="fa fa-archive"></i><br>
			<span>我的资产</span>
		</a>
		<a href="#/more">
			<i class="fa fa-ellipsis-h"></i><br>
			<span>更多</span>
		</a>
	</div>

</body>
<!-- home template -->
<script type="text/ng-template" id="home.html">
	<div class="nav head">
		<span>{{title}}</span>
	</div>
	<!---->
	<div class="carousel" id="carousel">
		<ul>
			<li style="background-color: #0c63ee"><a href="#"><img src="" alt=""></a></li>
			<li style="background-color: #e42012"><a href="#"><img src="" alt=""></a></li>
			<li style="background-color: #1AEE0C"><a href="#"><img src="" alt=""></a></li>
		</ul>
		<ol>
		</ol>
	</div>
	
</script>
<!-- pro template -->
<script type="text/ng-template" id="pro.html">
	<div class="nav head">
		<span>{{title}}</span>
	</div>
	<!---->
	<div class="pro" id="pro">
		<ul class="pro_list">
			<li style="background-color: #123456"></li>
			<li style="background-color: green"></li>
			<li style="background-color: blue"></li>
			<li style="background-color: red"></li>
		</ul>
	</div>
	
</script>
<!-- cash template -->
<script type="text/ng-template" id="cash.html">
	<div class="nav head">
		<span>{{title}}</span>
	</div>
	<div class="cash" id="cash">
		<div class="cash_top">
			<p>
				<span>总资产（元）</span>
				<a href="javascript:;">
					交易记录&nbsp;<i class="fa fa-angle-double-right"></i>
				</a>
			</p>
			<h2>0.00</h2>
		</div>
		<div class="cash_middle">
			<div class="cash_m_yesterday">
				<p>昨日收益（元）</p>
				<h2>0.00</h2>
			</div>
			<div class="cash_m_all">
				<p>累计收益（元）</p>
				<h2>24.16</h2>
			</div>
		</div>
	</div>
</script>
<!-- more template -->
<script type="text/ng-template" id="more.html">
	<div class="nav head">
		<span>{{title}}</span>
	</div>
</script>

<script type="text/javascript">
	// 重置HTML的rem
	function reSetRem(){
		var html = document.getElementsByTagName("html")[0];
		var rem = document.body.clientWidth/10;
		if(window.navigator.userAgent.match(/Firefox/gi)){
			rem = screen.availWidth/10;
		}
		html.style.fontSize = rem+"px";
	}
	reSetRem();
</script>

<script type="text/javascript">

	// 切换栏目根据路由给出active
	function footActive(index){

		var foot_link = document.getElementById("foot").getElementsByTagName("a");

		for(var i=0; i<foot_link.length; i++){
			foot_link[i].className = "";
		}
		foot_link[0].getElementsByTagName("i")[0].className = "fa fa-star-o";
		foot_link[index].className = "active";

		if(index===0){
			foot_link[index].getElementsByTagName("i")[0].className = "fa fa-star";

		}
	}
	
</script>




<script type="text/javascript">
	// 设置products栏目的高度
	// 在用户切换到产品栏目运行
	function setProHeight(){

		var pro = document.getElementById("pro");

		var proH = window.innerHeight - document.body.clientWidth/10*2 - 30;

		if(window.navigator.userAgent.match(/Firefox/gi)){
			proH = window.innerHeight - screen.availWidth/10*2 - 30;
		}
		
		pro.style.height = proH + "px";

		// 监听页面的缩放，改变产品栏目的高度
		window.addEventListener("resize", function(){
			setProHeight();
		})

	}

</script>

<script type="text/javascript">
	
	// 产品栏目的列表切换程序
	function proRun(){

		var proList = document.getElementById("pro").getElementsByTagName("ul")[0];
		var proE = proList.getElementsByTagName("li");
		var proLen = proList.getElementsByTagName("li").length;

		var proAnimate = [];

		for(var i=0; i<proLen; i++){

			proE[i].style.zIndex = proLen-i;
			proE[i].style.transform = "matrix("+(0.6-i*0.1)+", 0, 0, "+(0.9-i*0.15)+", "+(50+-i*50)+", 10)";
			proE[i].style["-moz-transform"] = "matrix("+(0.6-i*0.1)+", 0, 0, "+(0.9-i*0.15)+", "+(50+-i*50)+", 10)";
			proE[i].style["-webkit-transform"] = "matrix("+(0.6-i*0.1)+", 0, 0, "+(0.9-i*0.15)+", "+(50+-i*50)+", 10)";

			proAnimate.push(proE[i]);

		}

		proAnimate.forEach(function (el, i){
			// console.log(el, i)
			el.style.transition = "all .3s ease-in-out";
			el.style["-moz-transition"] = "all .3s ease-in-out";
			el.style["-webkit-transition"] = "all .3s ease-in-out";

			el.addEventListener("touchstart", function proSwapSatrt (e){

				var changedDom = this;

				console.log(changedDom)

				var SX = e.changedTouches[0].clientX;
				var SY = e.changedTouches[0].clientY;

				document.addEventListener("touchend", function proSwapEnd (e){

					var EX = e.changedTouches[0].clientX;
					var EY = e.changedTouches[0].clientY;

					var X = EX - SX, Y = EY - SY;

					if(X>70){
						changedDom.style.transform = "matrix(.6, 0, 0, .9, "+400+", 0)";
						changedDom.style["-moz-transform"] = "matrix(.6, 0, 0, .9, "+400+", 0)";
						changedDom.style["-webkit-transform"] = "matrix(.6, 0, 0, .9, "+400+", 0)";
					}else if(X<-70){
						changedDom.style.transform = "matrix(.6, 0, 0, .9, "+-400+", 0)";
						changedDom.style["-moz-transform"] = "matrix(.6, 0, 0, .9, "+-400+", 0)";
						changedDom.style["-webkit-transform"] = "matrix(.6, 0, 0, .9, "+-400+", 0)";
					}else{
						return false;
					}

					proAnimate.push(proAnimate.shift());

					setTimeout(function(){

						proAnimate.forEach(function (e, i){

							e.style.transform = "matrix("+(0.6-i*0.1)+", 0, 0, "+(0.9-i*0.15)+", "+(50+-i*50)+", 10)";
							e.style["-moz-transform"] = "matrix("+(0.6-i*0.1)+", 0, 0, "+(0.9-i*0.15)+", "+(50+-i*50)+", 10)";
							e.style["-webkit-transform"] = "matrix("+(0.6-i*0.1)+", 0, 0, "+(0.9-i*0.15)+", "+(50+-i*50)+", 10)";
							
							e.style.zIndex = proLen-i;

						});

					},200);

					// changedDom = null;
					document.removeEventListener("touchend", proSwapEnd);
					 
				});

			});
		});
	}
	

</script>



<script type="text/javascript">
	var myApp = angular.module('myApp', ['ngRoute']);

	// 路由控制
	myApp.config(function ($routeProvider){

		$routeProvider.when("/", {
			url: "/home",
			abstract: true,
			templateUrl: 'home.html',
			scope: {
				route : "home"
			},
			controller: "HomeCtrl"
		}).when("/pro", {
			url: "/pro",
			abstract: true,
			templateUrl: "pro.html",
			scope: {
				route : "pro"
			},
			controller: "ProCtrl"
		}).when("/cash", {
			url: "/cash",
			abstract: true,
			templateUrl: "cash.html",
			scope: {
				route : "cash"
			},
			controller: "CashCtrl"
		}).when("/more", {
			url: "/more",
			abstract: true,
			templateUrl: "more.html",
			scope: {
				route : "more"
			},
			controller: "MoreCtrl"
		}).otherwise({
			redirectTo: "/"
		})

	});

	// 添加控制器
	myApp.controller("HomeCtrl", function ($scope){
		$scope.title = "精选推荐";
		footActive(0);
		run();
	});
	myApp.controller("ProCtrl", function ($scope){
		$scope.title = "产品列表";
		footActive(1);
		setProHeight();
		proRun();
	});
	myApp.controller("CashCtrl", function ($scope){
		$scope.title = "我的资产";
		footActive(2);
	});
	myApp.controller("MoreCtrl", function ($scope){
		$scope.title = "更多";
		footActive(3);
	});


	

</script>


<script type="text/javascript">

	// 首页的图片轮播程序
	function run(){
		var carousel = document.getElementById("carousel");
		var carouselUl = carousel.getElementsByTagName("ul")[0];
		var carouselLen = carouselUl.getElementsByTagName("li").length;
		var carouselOl = carousel.getElementsByTagName("ol")[0];

		carouselUl.style.width = carouselLen*10+"rem";
		for(var i=0; i<carouselLen; i++){
			var li = document.createElement("li");
			if(i === 0){
				li.innerHTML = '<i class="fa fa-circle"></i>';
				li.className = "active"
			}else{
				li.innerHTML = '<i class="fa fa-circle-o"></i>';
			}
			carouselOl.appendChild(li);
		}

		var timer = null, index = 0;

		timer = setInterval(function(){
			index++;
			index = index%3;
			runCarousel(index);
			console.log(index+"--"+new Date().getTime());
		}, 3000);

		carousel.addEventListener("touchstart", function carouselStart(e){
			var SX = e.changedTouches[0].clientX;
			var SY = e.changedTouches[0].clientY;

			clearInterval(timer);

			document.addEventListener("touchend", function documentEnd(e){
				var EX = e.changedTouches[0].clientX;
				var EY = e.changedTouches[0].clientY;

				var X = EX - SX, Y = EY - SY;

				if(X<-20){

					index++;
					index = index%3;
					runCarousel(index);
					console.log(index+"--"+new Date().getTime());

				}else if(X>20){

					index--;
					if(index<0) index = 0;
					index = index%3;
					runCarousel(index);

				}else{
					return false;
				}
				clearInterval(timer);

				timer = setInterval(function(){
					index = index%3;
					runCarousel(index);
					console.log(index+"--"+new Date().getTime());
					index++;
				}, 3000);

				document.removeEventListener("touchend", documentEnd);

			});
		});

		function runCarousel(index){
			carouselUl.className = "active"+(index+1);
			for(var i=0; i<carouselLen; i++){
				carouselOl.getElementsByTagName("li")[i].className = "";
				carouselOl.getElementsByTagName("li")[i].getElementsByTagName("i")[0].className = "fa fa-circle-o";
			}
			carouselOl.getElementsByTagName("li")[index].className = "active";
			carouselOl.getElementsByTagName("li")[index].getElementsByTagName("i")[0].className = "fa fa-circle";

		}
	}
</script>
</html>